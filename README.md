# Домашнее задание к занятию «Репликация и масштабирование.
Иванов Владислав

### Задание 1
Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер;
- master-сервер и несколько slave-серверов;

Дайте ответ в свободной форме.


### Задание 2
Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц:
- пользователи,
- книги,
- магазины (столбцы произвольно).
Опишите принципы построения системы и их разграничение или разбивку между базами данных.

Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.


### РЕШЕНИЕ

### Задание 1

### **Преимущества масштабирования**  

#### 1. Активный master-сервер и пассивный репликационный slave-сервер
Преимущества:

- **Высокая доступность: Если master выйдет из строя, slave может быть быстро переведён в режим master.
- **Распределение нагрузки: Запросы на чтение (SELECT) можно перенаправлять на slave, разгружая master.
- **Резервное копирование: Slave можно использовать для бэкапов без нагрузки на master.
- **Простота настройки: Легче управлять, чем кластер из нескольких серверов.

### 2. Master-сервер и несколько slave-серверов
Преимущества:

- **Масштабируемость чтения: Запросы на чтение распределяются между несколькими slave, что ускоряет обработку.
- **Геораспределение: Slave можно размещать в разных регионах для уменьшения задержки.
- **Отказоустойчивость: Если один slave упадёт, остальные продолжат работать.
- **Гибкость: Можно использовать разные slave для разных задач (аналитика, бэкапы, тестирование).



### Задание 2

### Архитектура распределённой СУБД

**Состав базы данных:**
- Пользователи (ID, имя, email, дата регистрации)
- Книги (ID, название, автор, цена, жанр)
- Магазины (ID, название, местоположение, менеджер)

---

## Стратегии распределения данных

### 1. Вертикальное разделение (по таблицам)

**Схема распределения:**
- **Основной узел (Primary):**
  - Таблица пользователей (активные операции)
  - Таблица магазинов (часто обновляемые данные)
  - Режим: чтение/запись

- **Дополнительный узел (Secondary):**
  - Каталог книг (преимущественно чтение)
  - Режим: только чтение

**Преимущества:**
- Оптимальное использование ресурсов
- Минимизация блокировок при операциях записи
- Эффективное кэширование часто читаемых данных

### 2. Горизонтальное разделение (по строкам)

**Методика распределения:**

#### Для пользователей:
- **Критерий:** Хэш от ID пользователя
- **Шард 1:** ID % 3 = 0
- **Шард 2:** ID % 3 = 1 
- **Шард 3:** ID % 3 = 2

#### Для книг:
- **Критерий:** Принадлежность к магазину
- **Группа A:** Магазины 1,4,7...
- **Группа B:** Магазины 2,5,8...
- **Группа C:** Магазины 3,6,9...

**Обоснование выбора:**
- Равномерное распределение нагрузки
- Локализация связанных данных
- Упрощение масштабирования

---

## Схема развёртывания

```plaintext
Главный сервер (Primary)
├── Пользователи (шард 0)
├── Магазины
│
├─Репликация─▶ Реплика 1 (Secondary)
│             ├── Книги (группа A)
│             └── Пользователи (шард 1)
│
└─Репликация─▶ Реплика 2 (Secondary)
               ├── Книги (группа B)
               └── Пользователи (шард 2)

## **Блок-схема**

```
┌───────────────────┐       ┌───────────────────┐
│      Master       │       │      Slave 1      │
│  (Read-Write)     │──────▶│   (Read-Only)     │
│                   │       │                   │
│  Таблицы:         │       │  Таблицы:         │
│  - users (шард 0) │       │  - books (шард A) │
│  - stores         │       └───────────────────┘
└─────────┬─────────┘
          │
          ▼
┌───────────────────┐       ┌───────────────────┐
│      Slave 2      │       │      Slave 3      │
│  (Read-Write)     │       │  (Read-Write)     │
│                   │       │                   │
│  Таблицы:         │       │  Таблицы:         │
│  - users (шард 1) │       │  - users (шард 2) │
│  - books (шард B) │       │  - books (шард C) │
└───────────────────┘       └───────────────────┘
```
